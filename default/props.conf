[dnsmasq]
LINE_BREAKER=[\r\n]+
SHOULD_LINEMERGE=false
TZ=America/Los_Angeles
EXTRACT-dnsmasq-dhcp = (?^uix: ^ ... \s .. \s ..:..:.. \s dnsmasq-dhcp\[(?<pid>\d+)\]: \s (?: (?<request_id> \d+ ) \s (?: available \s DHCP \s range: \s (?<dhcp_range_start> \S+ ) \s -- \s (?<dhcp_range_end> \S+ ) | vendor \s class: \s (?<dhcp_vendor_class> .*? ) | client \s provides \s name: \s (?<dhcp_client_name> .*? ) | (?<dhcp_eventype> DHCPREQUEST ) \( (?<dhcp_interface> [a-z0-9:_]+ ) \) \s (?<dhcp_ip> \S+ ) \s (?<dhcp_mac_address> \S+ ) | (?<dhcp_eventype> DHCPACK ) \( (?<dhcp_interface> [a-z0-9:_]+ ) \) \s (?<dhcp_ip> \S+ ) \s (?<dhcp_mac_address> \S+ ) \s (?<dhcp_client_name> [^\n]*? ) | (?<dhcp_eventype> DHCPDISCOVER ) \( (?<dhcp_interface> [a-z0-9:_]+ ) \) \s (?: (?<dhcp_ip> \S+ ) \s )? (?<dhcp_mac_address> \S+ ) | (?<dhcp_eventype> DHCPOFFER ) \( (?<dhcp_interface> [a-z0-9:_]+ ) \) \s (?<dhcp_ip> \S+ ) \s (?<dhcp_mac_address> \S+ ) | (?<dhcp_eventype> DHCPINFORM ) \( (?<dhcp_interface> [a-z0-9:_]+ ) \) \s (?<dhcp_ip> \S+ ) \s (?<dhcp_mac_address> \S+ ) | (?<dhcp_action> [A-Z]+ ) \( (?<dhcp_interface> \S+ ) \) | tags: \s (?<dhcp_tags> .*? ) | requested \s options: \s (?<dhcp_requested_options> .*? ) | next \s server: \s (?<dhcp_next_server> \S+ ) | (?<dhcp_eventtype> broadcast \s response ) | (?<dhcp_eventtype> sent \s size ) : \s+ (?<dhcp_option_size> \d+ ) \s+ option: \s+ (?<dhcp_option_id> \d+ ) \s+ (?<dhcp_option_name> \S .*? ) \s\s (?<dhcp_option_value> .*? ) ) | (?<dhcp_eventtype> Ignoring \s domain ) \s (?<dhcp_domain> \S+ ) \s for \s DHCP \s host \s name \s (?<dhcp_host> \S+ ) ) \s* $ )
EXTRACT-dnsmasq-dns = (?^uix: ^ ... \s .. \s ..:..:.. \s dnsmasq\[(?<pid>\d+)\]: \s (?: (?<request_id>\d+) \s (?<peer>[^\s/]+) / (?<peer_port>\d+) \s (?: (?<type> [a-z]+ ) (?: (?<= query ) \[ (?<record_type> [^\]]+ ) \] )? \s )? | (?<type>reply) \s ) (?<query> [\s\S]+? ) \s (?: from \s (?<client_address> \S+ ) | to \s (?<server> \S+ ) | is \s (?<result> \S+ ) ) $ )

